<!DOCTYPE html>
<html class="screen-desktop-wide device-desktop">
<head profile="http://www.w3.org/2005/10/profile">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<title>指派给我 - 然之协同</title>
<link rel="stylesheet" href="lib/zui/css/zui.min.css" />
<link rel="stylesheet" href="lib/zui/css/zui-theme.min.css" />
<script src="lib/jquery/jquery-3.2.1.min.js"></script>
<script src="lib/jquery/jquery.validate.min.js"></script>
<script src="lib/jquery/jquery.validate.unobtrusive.min.js"></script>
<script src="lib/zui/js/zui.min.js"></script>

<script language="Javascript">
	var config = {
		"webRoot" : "\/",
		"appName" : "sys",
		"cookieLife" : 30,
		"requestType" : "GET",
		"requestFix" : "-",
		"moduleVar" : "m",
		"methodVar" : "f",
		"viewVar" : "t",
		"defaultView" : "html",
		"themeRoot" : "\/theme\/",
		"currentModule" : "my",
		"currentMethod" : "task",
		"clientLang" : "zh-cn",
		"requiredFields" : "",
		"save" : "\u4fdd\u5b58",
		"router" : "\/sys\/index.php",
		"runMode" : "front",
		"timeout" : 30000,
		"pingInterval" : 60
	}
</script>
<script language="Javascript">
	if (typeof (v) != "object")
		v = {};
	v.entryID = "superadmin";
</script>
<link rel="stylesheet" href="css/all.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/all.css" type="text/css" media="print">
<link rel="stylesheet" href="css/ips.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/ips.css" type="text/css" media="print">
<script src="js/all.js" type="text/javascript"></script>
<style>
.categoryButton, .categoryMenu li button {
	height: 40px;
	width: 40px;
	padding: 6px;
	text-align: center;
}

.categoryButton .icon, .categoryMenu li .app-btn .icon {
	color: rgba(255, 255, 255, 0.8);
	line-height: 28px;
	text-align: center;
	text-shadow: 0 1px 1px rgba(0, 0, 0, 0.35);
	border-radius: 5px;
	box-shadow: 0 1px 1px rgba(0, 0, 0, 0.35);
	display: inline-block;
	font-size: 12px;
	font-weight: normal;
	min-width: 28px;
}

.categoryMenu {
	opacity: 1;
	left: 39px;
	padding: 0px 5px 0px 5px;
}

.categoryMenu li {
	float: left;
}

.categoryButton.active, .categoryMenu li button.active {
	background-color: rgba(255, 255, 255, 0.2);
	color: rgba(255, 255, 255, 0.85);
}
</style>
<script language="Javascript">
v.lang = {
		"confirmDelete":"\u60a8\u786e\u5b9a\u8981\u6267\u884c\u5220\u9664\u64cd\u4f5c\u5417\uff1f","
		confirmFinish":"\u60a8\u786e\u5b9a\u8981\u6267\u884c\u5b8c\u6210\u64cd\u4f5c\u5417\uff1f",
		"deleteing":"\u5220\u9664\u4e2d","doing":"\u5904\u7406\u4e2d",
		"timeout":"\u7f51\u7edc\u8d85\u65f6,\u8bf7\u91cd\u8bd5",
		"confirmDiscardChanges":"\u8868\u5355\u5df2\u66f4\u6539\uff0c\u786e\u5b9a\u5173\u95ed\uff1f",
		"yes":"\u662f","no":"\u5426"
		};
</script>
</head>
<body class="m-index-index" style="background-color: rgb(20, 92, 205);">
	<script src="js/ips.js" type="text/javascript"></script>
	<script language="Javascript">
		v.attend = 1;
	</script>
	<!-- Desktop -->
	<div id="desktop" class="">
		<!-- BEGIN：左侧栏 -->
		<div id="leftBar" class="dock-left unselectable">
			<!--BEGIN:开始按钮和开始菜单-->
			<button id="start" class="dock-bottom" type="button" title="demo">
				<div class="avatar avatar-md"></div>
			</button>
			<ul id="startMenu" class="dropdown-menu fade">
				<li class="with-avatar"><a href="main.html" data-toggle="modal"
					data-id="profile">
						<div class="avatar avatar-md"></div> <strong>demo</strong>
				</a></li>
				<li class="divider"></li>
				<li class="dropdown-submenu"><a href="###"
					data-toggle="dropdown" class="dropdown-toggle"><i
						class="icon icon-globe"></i> 简体</a>
					<ul class="dropdown-menu">
						<li><a href='javascript:selectLang("zh-tw")'>繁體</a></li>
						<li><a href='javascript:selectLang("en")'>English</a></li>
					</ul></li>
				<li class="dropdown-submenu"><a href="###"
					data-toggle="dropdown" class="dropdown-toggle"><i
						class="icon icon-adjust"></i> 主题</a>
					<ul class="dropdown-menu">
						<li class="theme-option active"><a
							href='javascript:selectTheme("default");' data-value="default">默认</a></li>
						<li class="theme-option"><a
							href='javascript:selectTheme("clear");' data-value="clear">清晰</a></li>
					</ul></li>
				<li><a
					href="http://demo.ranzhi.org/sys/index.php?m=misc&amp;f=about"
					data-id="about" data-toggle="modal" data-width="500"><i
						class="icon icon-info-sign"></i> 关于</a></li>
				<li class="divider"></li>
				<li><a
					href="http://demo.ranzhi.org/sys/index.php?m=entry&amp;f=create"
					data-id="superadmin" class="app-btn"><i class="icon icon-plus"></i>
						添加应用</a></li>
				<li><a href="javascript:;" class="fullscreen-btn"
					data-id="allapps"><i class="icon icon-th-large"></i> 所有应用</a></li>
				<li class="divider"></li>
				<li><a
					href="http://demo.ranzhi.org/sys/index.php?m=user&amp;f=logout"><i
						class="icon icon-signout"></i> 退出</a></li>
			</ul>
			<!--END:开始按钮和开始菜单-->
			<!--BEGIN:APP DASH-->
			<div id="apps-menu">
				<ul class="bar-menu">
					<li id="s-menu-dashboard" data-order="0"><button
							data-toggle="tooltip" data-tip-class="s-menu-tooltip"
							data-placement="right" data-btn-type="menu"
							class="app-btn s-menu-btn open active" title="我的地盘"
							data-id="dashboard">
							<i class="icon icon-home"></i>
						</button></li>
					<li id="s-menu-1" data-order="1"><button data-toggle="tooltip"
							data-tip-class="s-menu-tooltip" data-placement="right"
							data-btn-type="menu" class="app-btn s-menu-btn" title=""
							data-id="1" data-original-title="客户管理">
							<img src="img/app-crm.png" alt="">
						</button></li>
					<li id="s-menu-superadmin" data-order="7"><button
							data-toggle="tooltip" data-tip-class="s-menu-tooltip"
							data-placement="right" data-btn-type="menu"
							class="app-btn s-menu-btn" title="后台管理" data-id="superadmin">
							<i class="icon icon-cog"></i>
						</button></li>
					<li id="s-menu-allapps" data-order="8"><button
							data-toggle="tooltip" data-tip-class="s-menu-tooltip"
							data-placement="right" data-btn-type="menu"
							class="app-btn s-menu-btn" title="所有应用" data-id="allapps">
							<i class="icon icon-th-large"></i>
						</button></li>
				</ul>

				<!--BEGIN:当显示不开时，显示更多按钮-->
				<button id="moreOptionBtn" data-toggle="tooltip"
					data-tip-class="s-menu-tooltip" data-placement="right"
					data-btn-type="menu" class="btn-more" data-original-title="...">
					<i class="icon icon-ellipsis-h"></i>
				</button>
				<ul id="moreOptionMenu" class="bar-menu dropdown-menu fade">
					<li id="s-menu-dashboard" data-order="0"><button
							data-toggle="tooltip" data-tip-class="s-menu-tooltip"
							data-placement="right" data-btn-type="menu"
							class="app-btn s-menu-btn open active" title="我的地盘"
							data-id="dashboard">
							<i class="icon icon-home"></i>
						</button></li>
					<li id="s-menu-1" data-order="1"><button data-toggle="tooltip"
							data-tip-class="s-menu-tooltip" data-placement="right"
							data-btn-type="menu" class="app-btn s-menu-btn" title="客户管理"
							data-id="1">
							<img src="img/app-crm.png" alt="">
						</button></li>
					<li id="s-menu-superadmin" data-order="7"><button
							data-toggle="tooltip" data-tip-class="s-menu-tooltip"
							data-placement="right" data-btn-type="menu"
							class="app-btn s-menu-btn" title="后台管理" data-id="superadmin">
							<i class="icon icon-cog"></i>
						</button></li>
					<li id="s-menu-allapps" data-order="8"><button
							data-toggle="tooltip" data-tip-class="s-menu-tooltip"
							data-placement="right" data-btn-type="menu"
							class="app-btn s-menu-btn" title="所有应用" data-id="allapps">
							<i class="icon icon-th-large"></i>
						</button></li>
				</ul>
				<!--END:当显示不开时，显示更多按钮-->
			</div>
			<!--END:APP DASH-->
		</div>
		<!-- END：左侧栏 -->
		<div id="bottomBar" class="dock-bottom unselectable">
			<!-- BEGIN：任务栏 -->
			<div id="taskbar">
				<ul class="bar-menu">
					<li id="s-task-dashboard"><button
							class="app-btn s-task-btn open active" title="我的地盘"
							data-btn-type="task" data-id="dashboard">
							<i class="icon icon-home"></i>我的地盘
						</button></li>
					<li id="s-task-dashboard"><button class="app-btn s-task-btn"
							title="谁的地盘" data-btn-type="task" data-id="dashboard">
							<i class="icon icon-home"></i>谁的地盘
						</button></li>
				</ul>
			</div>
			<!-- END：任务栏 -->
			<!-- BEGIN：系统托盘 -->
			<div id="bottomRightBar" class="dock-right">
				<ul class="bar-menu">
					<li><a href="javascript:void(0)" class="sign signout">签退</a></li>
					<li><button id="showDesk" type="button"
							class="fullscreen-btn icon-desktop" data-id="home"
							data-toggle="tooltip" title="桌面"></button></li>
				</ul>
				<div class="copyright">
					<a href="http://www.ranzhi.org/?v=4.8" target="_blank">然之协同 4.8</a>
				</div>
			</div>
			<!-- END:系统托盘 -->
		</div>
		<!-- BEGI：主功能区 -->
		<div id="home" class="fullscreen unselectable"
			style="width: 1880px; left: 40px; top: 0px; bottom: 36px;">
			<nav class="navbar navbar-main navbar-fixed-top" id="mainNavbar">
				<div class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li><a
							href="http://demo.ranzhi.org/sys/index.php?m=user&amp;f=profile"
							data-toggle="modal" data-id="profile"><i class="icon-user"></i>
								demo</a></li>
					</ul>
					<ul class="nav navbar-nav">
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=todo&amp;f=calendar">待办</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=task">任务</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=project">项目</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=order">订单</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=contract">合同</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=review">审批</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=company">组织</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=dynamic">动态</a></li>
						<li><a class="app-btn open active" data-id="dashboard"
							href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=contact">联系人</a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li><a class="navbar-brand" href=""></a></li>
						<li><a href="javascript:;" class="refresh-all-panel"><i
								class="icon-repeat"></i></a></li>
						<li><a data-toggle="modal"
							href="http://demo.ranzhi.org/sys/index.php?m=block&amp;f=admin"
							title="添加区块"><i class="icon-plus"></i></a></li>
					</ul>
				</div>
			</nav>
			<div id="dashboardWrapper">
				<div class="panels-container dashboard dashboard-draggable"
					id="dashboard" data-confirm-remove-block="确定移除区块【{0}】吗？">
					<div class="row">
						<div class="col-xs-6 pull-left">
							<div class="panel panel-default" id="block1" data-id="1"
								data-blockid="71" data-name="任务列表"
								data-url="/sys/index.php?m=entry&amp;f=printBlock&amp;index=1"
								style="height: 240px;">
								<div class="panel-heading">
									<div class="panel-actions">
										<a
											href="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=task&amp;type=assignedTo"
											class="more app-btn open active" data-id="dashboard">更多<i
											class="icon-double-angle-right"></i></a>
										<button class="btn btn-mini refresh-panel" type="button">
											<i class="icon-repeat"></i>
										</button>
										<div class="dropdown">
											<button role="button" class="btn btn-mini"
												data-toggle="dropdown" type="button">
												<span class="caret"></span>
											</button>
											<ul class="dropdown-menu pull-right" role="menu">
												<li><a
													href="http://demo.ranzhi.org/sys/index.php?m=block&amp;f=admin&amp;index=1"
													data-toggle="modal" class="edit-block" data-title="任务列表"
													data-icon="icon-pencil"><i class="icon-pencil"></i> 编辑</a></li>
												<li><a href="javascript:;" class="remove-panel"><i
														class="icon-remove"></i> 删除</a></li>
											</ul>
										</div>
									</div>
									任务列表
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<!--  END:主功能区 -->
	<!-- BEGIN：全部APP -->
	<div id="allapps" class="fullscreen unselectable"
		style="width: 1880px; left: 40px; top: 0px; bottom: 36px;">
		<header>
			<ul class="nav" id="appSearchNav">
				<li><a href="javascript:;" class="app-search" data-key=""><i
						class="icon-th-large"></i> <span>所有应用</span> &nbsp;<small
						class="muted entries-count">9</small></a></li>
				<li><a href="javascript:;" class="app-search" data-key=":menu"><i
						class=""></i> <span>左侧显示</span> &nbsp;<small
						class="muted search-count"></small></a></li>
				<li><a href="javascript:;" class="app-search" data-key=":!menu"><i
						class=""></i> <span>非左侧显示</span> &nbsp;<small
						class="muted search-count"></small></a></li>
			</ul>
			<div class="search-input">
				<i class="icon-search icon"></i> <input id="search"
					class="form-control-pure form-control" type="text">
				<button id="cancelSearch" class="btn btn-pure btn-mini"
					type="button">
					<i class="icon-remove"></i>
				</button>
			</div>
			<div class="actions">
				<a href="http://demo.ranzhi.org/sys/index.php?m=entry&amp;f=create"
					data-id="superadmin" class="app-btn btn btn-pure"><i
					class="icon-plus"></i> 添加应用</a>
			</div>
		</header>
		<div class="all-apps-list" id="allAppsList">
			<ul class="bar-menu">
				<li id="s-applist-dashboard"><a href="javascript:;"
					class="app-btn menu-true s-list-btn open active" data-menu="true"
					data-btn-type="list" data-id="dashboard" data-code="dashboard"><i
						class="icon icon-home"></i>我的地盘</a></li>
				<li id="s-applist-1"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="1" data-code="crm"><img
						src="img/app-crm.png" alt="">客户管理</a></li>
				<li id="s-applist-8"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="8" data-code="proj"><img
						src="img/app-proj.png" alt="">项目</a></li>
				<li id="s-applist-4"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="4" data-code="team"><img
						src="img/app-team.png" alt="">团队</a></li>
				<li id="s-applist-9"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="9" data-code="doc"><img
						src="img/app-doc.png" alt="">文档</a></li>
				<li id="s-applist-3"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="3" data-code="oa"><img
						src="img/app-oa.png" alt="">日常办公</a></li>
				<li id="s-applist-2"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="2" data-code="cash"><img
						src="img/app-cash.png" alt="">现金记账</a></li>
				<li id="s-applist-6"><a href="javascript:;"
					class="app-btn menu-false s-list-btn" data-menu="false"
					data-btn-type="list" data-id="6" data-code="webapp1"><i
						class="icon icon-default"
						style="background-color: hsl(282, 100%, 40%)"><span>R</span><span
							class="text-extra">U</span></i>RunJS</a></li>
				<li id="s-applist-superadmin"><a href="javascript:;"
					class="app-btn menu-true s-list-btn" data-menu="true"
					data-btn-type="list" data-id="superadmin" data-code="superadmin"><i
						class="icon icon-cog"></i>后台管理</a></li>
			</ul>
		</div>
	</div>
	<!-- END:全部APP -->
	<div id="deskContainer">
		<div id="win-dashboard"
			class="window window-iframe window-fixed window-control-simple window-max window-active"
			style="width: 1880px; height: 930px; left: 40px; top: 0px; z-index: 100;"
			data-id="dashboard"
			data-url="http://demo.ranzhi.org/sys/index.php?m=my&amp;f=task"
			data-title="指派给我 - 然之协同">
			<div class="window-head">
				<i class="icon icon-home"></i><strong title="我的地盘">我的地盘</strong>
				<ul>
					<li><button class="reload-win">
							<i class="icon-repeat"></i>
						</button></li>
					<li><button class="min-win">
							<i class="icon-minus"></i>
						</button></li>
					<li><button class="max-win">
							<i class="icon-resize-full"></i>
						</button></li>
					<li><button class="close-win">
							<i class="icon-remove"></i>
						</button></li>
				</ul>
			</div>
			<div class="window-cover"></div>
			<div class="window-content" style="height: 930px;">
				<iframe id="iframe-dashboard" name="iframe-dashboard"
					src="module.html" allowtransparency="true" scrolling="auto"
					hidefocus="" style="width: 100%; height: 100%; left: 0px;"
					frameborder="no"></iframe>
			</div>
		</div>
	</div>
	<div id="modalContainer"></div>
	</div>
	<div id="categoryTpl" class="hide">
		<ul id="categoryMenucategoryid"
			class="category categoryMenu dropdown-menu fade" data-id="categoryid"
			style="display: none;"></ul>
	</div>
	<script>
var entries = [
{
    id        : 'dashboard',
    code      : 'dashboard',
    name      : '我的地盘',
    abbr      : '我的',
    open      : 'iframe',
    desc      : '我的地盘',
    menu      : 'all',
    sys       : true,
    icon      : 'icon-home',
    url       : '/sys/index.php?m=todo&f=calendar',
    order     : 0, 
},
{
    id        : 'allapps',
    code      : 'allapps',
    name      : '所有应用',
    display   : 'fullscreen',
    desc      : '所有应用',
    menu      : 'menu',
    icon      : 'icon-th-large',
    sys       : true,
    forceMenu : true,
    order     : 9999999
},
{
    id        : 'home',
    code      : 'home',
    name      : '',
    display   : 'fullscreen',
    menu      : 'none',
    icon      : 'icon-desktop',
    sys       : true,
    forceMenu : true,
    order     : 9999998
}];


entries.push(
{
    id    : 'superadmin',
    code  : 'superadmin',
    name  : '后台管理',
    open  : 'iframe',
    desc  : '后台管理',
    menu  : 'all',
    sys   : true,
    icon  : 'icon-cog',
    url   : "/sys/index.php?m=admin&f=index",
    order : 9999997
});

var ipsLang = {};
ipsLang["confirmClose"] = "确认要关闭　【{0}】 吗？";
ipsLang["entryNotFindTip"] = "应用没有找到！";
ipsLang["busyTip"] = "应用正忙，请稍候...";
ipsLang["reloadText"] = "刷新";
ipsLang["closeText"] = "关闭";
ipsLang["openText"] = "打开";
ipsLang["removeText"] = "移除";
ipsLang["fixToMenuText"] = "左侧显示";
ipsLang["removeFromMenuText"] = "左侧移除";
ipsLang["deleteEntryText"] = "删除应用";
ipsLang["removedEntry"] = "应用【{0}】已删除";
ipsLang["confirmRemoveEntry"] = "确定移除应用【{0}】吗？";
ipsLang["showWindowText"] = "显示";
ipsLang["confirmRemoveBlock"] = "确定要删除区块 【{0}】 吗？";
ipsLang["removedBlock"] = "区块已删除";
ipsLang["hiddenBlock"] = "区块已隐藏";
ipsLang["orderdBlocksSaved"] = "排序已保存";
ipsLang["moreOptionTip"] = "显示另外 {0} 个应用";
ipsLang["confirmCloseBrowser"] = "提示：当前有打开的应用窗口";

entries.push(
            {
                id:       '1',
                code:     'crm',
                name:     '客户管理',
                url:      '/sys/index.php?m=entry&f=visit&entryID=1',
                open:     'iframe', 
                desc:     '客户管理',
                size:      'max',
                icon:     '/theme/default/images/ips/app-crm.png',
                control:  'simple',
                position: 'default',
                menu:     'all',
                display:  'fixed',
                abbr:     '客户',
                order:    '20',
                sys:      '1',
                category: '0'
            });
entries.push(
            {
                id:       '8',
                code:     'proj',
                name:     '项目',
                url:      '/sys/index.php?m=entry&f=visit&entryID=8',
                open:     'iframe', 
                desc:     '项目',
                size:      'max',
                icon:     '/theme/default/images/ips/app-proj.png',
                control:  'simple',
                position: 'default',
                menu:     'all',
                display:  'fixed',
                abbr:     '项目',
                order:    '30',
                sys:      '1',
                category: '0'
            });
entries.push(
            {
                id:       '4',
                code:     'team',
                name:     '团队',
                url:      '/sys/index.php?m=entry&f=visit&entryID=4',
                open:     'iframe', 
                desc:     '团队',
                size:      'max',
                icon:     '/theme/default/images/ips/app-team.png',
                control:  'simple',
                position: 'default',
                menu:     'all',
                display:  'fixed',
                abbr:     '团队',
                order:    '40',
                sys:      '1',
                category: '0'
            });
entries.push(
            {
                id:       '9',
                code:     'doc',
                name:     '文档',
                url:      '/sys/index.php?m=entry&f=visit&entryID=9',
                open:     'iframe', 
                desc:     '文档',
                size:      'max',
                icon:     '/theme/default/images/ips/app-doc.png',
                control:  'simple',
                position: 'default',
                menu:     'all',
                display:  'fixed',
                abbr:     '文档',
                order:    '50',
                sys:      '1',
                category: '0'
            });
entries.push(
            {
                id:       '3',
                code:     'oa',
                name:     '日常办公',
                url:      '/sys/index.php?m=entry&f=visit&entryID=3',
                open:     'iframe', 
                desc:     '日常办公',
                size:      'max',
                icon:     '/theme/default/images/ips/app-oa.png',
                control:  'simple',
                position: 'default',
                menu:     'all',
                display:  'fixed',
                abbr:     '办公',
                order:    '60',
                sys:      '1',
                category: '0'
            });
entries.push(
            {
                id:       '2',
                code:     'cash',
                name:     '现金记账',
                url:      '/sys/index.php?m=entry&f=visit&entryID=2',
                open:     'iframe', 
                desc:     '现金记账',
                size:      'max',
                icon:     '/theme/default/images/ips/app-cash.png',
                control:  'simple',
                position: 'default',
                menu:     'all',
                display:  'fixed',
                abbr:     '记账',
                order:    '70',
                sys:      '1',
                category: '0'
            });
entries.push(
            {
                id:       '6',
                code:     'webapp1',
                name:     'RunJS',
                url:      '/sys/index.php?m=entry&f=visit&entryID=6',
                open:     'blank', 
                desc:     'RunJS',
                size:      {"width":1024,"height":600},
                icon:     '',
                control:  'full',
                position: 'center',
                menu:     'list',
                display:  'sizeable',
                abbr:     '',
                order:    '100',
                sys:      '0',
                category: '0'
            });
</script>
<script language="Javascript">$(function()
{
    /* start ips */
    $.ipsStart(entries, $.extend({onBlocksOrdered: sortBlocks, onDeleteBlock: deleteBlock, 
    	onDeleteEntry: deleteEntry, onUpdateEntryMenu: updateEntryMenu, 
    	onSortEntries: sortEntries, onResize: resizeBlock}, 
    	config, ipsLang));
    
    if(v.attend)
    {
        initAttendButton();
        $('.sign').parent('li').show();
    }
    else
    {
        $('.sign').parent('li').hide();
    }

    $(document).on('mouseover', '.categoryButton', function()
    {
        $('.categoryButton').not('.open').removeClass('active');
        $(this).addClass('active');
        var id    = $(this).data('id');
        var menu  = $('#categoryMenu' + id);
        var lis   = menu.find('li');
        var color = $('body').css('background-color');
        menu.css({'background-color' : color, 'top' : $(this).offset().top - 3, 'width' : 40 * lis.size() + 20});
        $('.categoryMenu').not(menu).hide();
        menu.show();
    });

    $(document).on('mouseover', '.categoryMenu li .app-btn', function()
    {
        $('.categoryMenu li .app-btn').removeClass('active');
        $(this).addClass('active');
    });

    $(document).on('mouseout', '.categoryMenu li .app-btn', function()
    {
        $('.categoryMenu li .app-btn').removeClass('active');
        var id = $(this).parents('.categoryMenu').data('id');
        if(!$('#category' + id).hasClass('open')) $('#category' + id).removeClass('active');
    });

    $(document).on('click', '.categoryMenu li .app-btn', function()
    {
        $('.categoryMenu').hide();
        $('.categoryButton').removeClass('active');

        var id = $(this).parents('.categoryMenu').data('id');
        $('#category' + id).addClass('open active');
    });

    $(document).on('mouseover', '#leftBar #apps-menu .bar-menu li .app-btn', function()
    {
        $('.categoryButton').not(this).not('.open').removeClass('active');
        if(!$(this).hasClass('categoryButton')) $('.categoryMenu').hide();
    });

    $(document).on('click', '#leftBar #apps-menu .bar-menu li .app-btn', function()
    {
        $('.categoryButton').removeClass('active');
        $('.categoryMenu').hide();
    });

    $(document).on('click', '#bottomBar #taskbar .bar-menu li .app-btn', function()
    {
        $('.categoryButton').removeClass('active');
        var dataid = $(this).data('id');
        $('.categoryMenu li .app-btn').each(function()
        {
            if($(this).data('id') == dataid)
            {
                var id = $(this).parents('.categoryMenu').data('id');
                $('#category' + id).addClass('active');
                return;
            }
        });
    });

    $(document).mouseover(function(e)
    {
        $('.categoryMenu').each(function()
        {
            if($(this).is(':visible'))
            {
                var dataid  = $(this).data('id');
                var button  = $('#category' + dataid);
                var top     = button.offset().top;
                var left    = button.offset().left;
                var right   = left + button.width() + $(this).width();
                var bottom  = top + button.height() + $(this).height();
                if(e.pageX < left || e.pageX > right || e.pageY < top || e.pageY > bottom)
                {
                    $(this).hide();
                }
            }
        });
    });
});

/**
 * Update orders of entries
 * 
 * @param  object      orders
 * @param  function    callback after success
 * @access public
 * @return void
 */
function sortEntries(orders, callback)
{
    $.post(createLink('entry', 'customSort'), orders, function(data)
    {
        callback && callback(data.result == 'success');
    }, 'json');
}

/**
 * Update menu attribute of entry
 * 
 * @param  int         entry id 
 * @param  function    callback after success
 * @access public
 * @return void
 */
function updateEntryMenu(et, callback)
{
    $.post(createLink('entry', 'updateEntryMenu'), et, function(data)
    {
        callback && callback(data.result == 'success');
    }, 'json');
}

/**
 * Delete entry.
 * 
 * @param  object      entry 
 * @param  function    callback after delete success
 * @access public7
 * @return void
 */
function deleteEntry(et, callback)
{
    $.getJSON(createLink('entry', 'delete', 'code=' + et.code), function(data)
    {
        callback && callback(data.result == 'success');
    });
}

/**
 * Delete block.
 * 
 * @param  int    $index 
 * @access public
 * @return void
 */
function deleteBlock(index)
{
    $.getJSON(createLink('block', 'delete', 'index=' + index), function(data)
    {
        if(data.result != 'success')
        {
            alert(data.message);
            return false;
        }
    })
}

/**
 * Hidden block;
 * 
 * @param  index $index 
 * @access public
 * @return void
 */
function hiddenBlock(index)
{
    $.getJSON(createLink('block', 'delete', 'index=' + index + '&app=sys&type=hidden'), function(data)
    {
        if(data.result != 'success')
        {
            alert(data.message);
            return false;
        }
        reloadHome();
        $.zui.messager.info(ipsLang["hiddenBlock"]);
    })
}

/**
 * Sort blocks.
 * 
 * @param  object $orders  format is {'block2' : 1, 'block1' : 2, oldOrder : newOrder} 
 * @access public
 * @return void
 */
function sortBlocks(orders)
{
    var oldOrder = new Array();
    var newOrder = new Array();
    for(i in orders)
    {
       oldOrder.push(i.replace('block', ''));
       newOrder.push(orders[i]);
    }

    $.getJSON(createLink('block', 'sort', 'oldOrder=' + oldOrder.join(',') + '&newOrder=' + newOrder.join(',')), function(data)
    {
        if(data.result != 'success') return false;

        $('#home .panels-container .panel:not(.panel-dragging-holder)').each(function()
        {
            var $this = $(this);
            var index = $this.data('order');
            var url = createLink('entry', 'printBlock', 'index=' + index);
            /* Update new index for block id edit and delete. */
            $this.attr('id', 'block' + index).data('id', index).attr('data-url', url).data('url', url);
            $this.find('.panel-actions .edit-block').attr('href', createLink('block', 'admin', 'index=' + index));
        });
    });
}

/**
 * Resize block
 * @param  object $event
 * @access public
 * @return void
 */
function resizeBlock(event)
{
  var blockID = event.element.find('.panel').data('blockid');
  var data = event.type == 'vertical' ? event.height : event.grid;
  $.getJSON(createLink('block', 'resize', 'id=' + blockID + '&type=' + event.type + '&data=' + data), function(data)
  {
      if(data.result !== 'success') event.revert();
  });
}

/**
 * init sign in and sign out button.
 * 
 * @access public
 * @return void
 */
function initAttendButton()
{
    $('.signin').click(function()
    {
        $.getJSON(createLink('oa.attend', 'signin'), function(data)
        {
            if(data.result == 'success') $.zui.messager.success(data.message);
            if(data.result == 'fail') $.zui.messager.info(data.message);
        });
    });
    $('.signout').click(function()
    {
        $.getJSON(createLink('oa.attend', 'signout'), function(data)
        {
            if(data.result == 'success') window.location.href = createLink('user', 'logout');
            if(data.result == 'fail') $.zui.messager.info(data.message);
        });
    });
}

</script>



</body>
</html>